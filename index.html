<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>Counter DApp</title>
</head>

<body>
    <h1>Counter</h1>
    <p id="count">0</p>

    <button onclick="increment()">+</button>
    <button onclick="decrement()">-</button>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/6.10.0/ethers.umd.min.js"></script>
    <script>
        const contractAddress = "0xe7f1725e7734ce288f8367e1bb143e90bb3f0512";
        const abi = [
            "function count() view returns (uint256)",
            "function increment()",
            "function decrement()"
        ];

        let provider;
        let signer;
        let contract;

        async function init() {
            provider = new ethers.BrowserProvider(window.ethereum);
            signer = await provider.getSigner();
            contract = new ethers.Contract(contractAddress, abi, signer);
            refresh();
        }

        async function refresh() {
            const value = await contract.count();
            document.getElementById("count").innerText = value.toString();
        }

        async function increment() {
            const tx = await contract.increment();
            await tx.wait();
            refresh();
        }

        async function decrement() {
            try {
                const tx = await contract.decrement();
                await tx.wait();
                refresh();
            } catch (e) {
                alert("Cannot decrement below zero");
            }
        }

        init();
    </script>
</body>

</html>